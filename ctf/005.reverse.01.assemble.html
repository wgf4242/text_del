<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wgf4242&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/text_del/assets/css/0.styles.cf9e26c4.css" as="style"><link rel="preload" href="/text_del/assets/js/app.cb1aaf83.js" as="script"><link rel="preload" href="/text_del/assets/js/4.1570c86b.js" as="script"><link rel="preload" href="/text_del/assets/js/1.9204637f.js" as="script"><link rel="preload" href="/text_del/assets/js/24.f77110de.js" as="script"><link rel="prefetch" href="/text_del/assets/js/10.a1a16f3b.js"><link rel="prefetch" href="/text_del/assets/js/11.d0fc4eca.js"><link rel="prefetch" href="/text_del/assets/js/12.f1e7faa4.js"><link rel="prefetch" href="/text_del/assets/js/13.8c951298.js"><link rel="prefetch" href="/text_del/assets/js/14.e961b961.js"><link rel="prefetch" href="/text_del/assets/js/15.aaab3b66.js"><link rel="prefetch" href="/text_del/assets/js/16.43eee05c.js"><link rel="prefetch" href="/text_del/assets/js/17.086027bf.js"><link rel="prefetch" href="/text_del/assets/js/18.3f41df7b.js"><link rel="prefetch" href="/text_del/assets/js/19.efbba28d.js"><link rel="prefetch" href="/text_del/assets/js/2.14fcd092.js"><link rel="prefetch" href="/text_del/assets/js/20.6ca538ec.js"><link rel="prefetch" href="/text_del/assets/js/21.e96a7f20.js"><link rel="prefetch" href="/text_del/assets/js/22.e7c75172.js"><link rel="prefetch" href="/text_del/assets/js/23.d2dbca9e.js"><link rel="prefetch" href="/text_del/assets/js/25.ad3cdffc.js"><link rel="prefetch" href="/text_del/assets/js/26.8201a049.js"><link rel="prefetch" href="/text_del/assets/js/27.425bb1bd.js"><link rel="prefetch" href="/text_del/assets/js/28.438d9295.js"><link rel="prefetch" href="/text_del/assets/js/29.7e0bc7b5.js"><link rel="prefetch" href="/text_del/assets/js/30.eadc11e6.js"><link rel="prefetch" href="/text_del/assets/js/31.45ea8479.js"><link rel="prefetch" href="/text_del/assets/js/32.77231eb2.js"><link rel="prefetch" href="/text_del/assets/js/33.6d70ab89.js"><link rel="prefetch" href="/text_del/assets/js/34.0df5c65b.js"><link rel="prefetch" href="/text_del/assets/js/35.10cf4eef.js"><link rel="prefetch" href="/text_del/assets/js/36.e754010e.js"><link rel="prefetch" href="/text_del/assets/js/37.eb9ab54f.js"><link rel="prefetch" href="/text_del/assets/js/38.12bcf212.js"><link rel="prefetch" href="/text_del/assets/js/39.c4919376.js"><link rel="prefetch" href="/text_del/assets/js/40.0956c3db.js"><link rel="prefetch" href="/text_del/assets/js/41.d47c394f.js"><link rel="prefetch" href="/text_del/assets/js/42.0f918ea4.js"><link rel="prefetch" href="/text_del/assets/js/43.b62d29de.js"><link rel="prefetch" href="/text_del/assets/js/44.55c4b907.js"><link rel="prefetch" href="/text_del/assets/js/45.51e42e77.js"><link rel="prefetch" href="/text_del/assets/js/46.e48f7090.js"><link rel="prefetch" href="/text_del/assets/js/47.91e8a65b.js"><link rel="prefetch" href="/text_del/assets/js/48.2732fe72.js"><link rel="prefetch" href="/text_del/assets/js/49.4b469b80.js"><link rel="prefetch" href="/text_del/assets/js/5.988d478d.js"><link rel="prefetch" href="/text_del/assets/js/50.f4d30a6b.js"><link rel="prefetch" href="/text_del/assets/js/51.d650f987.js"><link rel="prefetch" href="/text_del/assets/js/52.24351146.js"><link rel="prefetch" href="/text_del/assets/js/53.d8ac36a9.js"><link rel="prefetch" href="/text_del/assets/js/54.62a75cf7.js"><link rel="prefetch" href="/text_del/assets/js/55.877b162a.js"><link rel="prefetch" href="/text_del/assets/js/6.dd916a57.js"><link rel="prefetch" href="/text_del/assets/js/7.ad32f933.js"><link rel="prefetch" href="/text_del/assets/js/8.714369a0.js"><link rel="prefetch" href="/text_del/assets/js/9.bf061ee9.js">
    <link rel="stylesheet" href="/text_del/assets/css/0.styles.cf9e26c4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>wgf4242's Blog</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>wgf4242's Blog</span>
            
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/text_del/" class="home-link router-link-active"><!----> <span class="site-name">wgf4242's Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/text_del/home/" class="nav-link"><i class="iconfont undefined"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      文章
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/text_del/article/technology/" class="nav-link"><i class="iconfont undefined"></i>
  技术
</a></li><li class="dropdown-item"><!----> <a href="/text_del/article/essay/" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/text_del/article/other/" class="nav-link"><i class="iconfont undefined"></i>
  其他
</a></li></ul></div></div><div class="nav-item"><a href="/text_del/about/" class="nav-link"><i class="iconfont undefined"></i>
  关于
</a></div><div class="nav-item"><a href="https://www.github.com/wgf4242" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-042e23d4><!----> <h3 class="name" data-v-042e23d4>
    wgf4242's Blog
  </h3> <div class="num" data-v-042e23d4><div data-v-042e23d4><h3 data-v-042e23d4>0</h3> <h6 data-v-042e23d4>Article</h6></div> <div data-v-042e23d4><h3 data-v-042e23d4>0</h3> <h6 data-v-042e23d4>Tag</h6></div></div> <hr data-v-042e23d4></div> <nav class="nav-links"><div class="nav-item"><a href="/text_del/home/" class="nav-link"><i class="iconfont undefined"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      文章
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/text_del/article/technology/" class="nav-link"><i class="iconfont undefined"></i>
  技术
</a></li><li class="dropdown-item"><!----> <a href="/text_del/article/essay/" class="nav-link"><i class="iconfont undefined"></i>
  随笔
</a></li><li class="dropdown-item"><!----> <a href="/text_del/article/other/" class="nav-link"><i class="iconfont undefined"></i>
  其他
</a></li></ul></div></div><div class="nav-item"><a href="/text_del/about/" class="nav-link"><i class="iconfont undefined"></i>
  关于
</a></div><div class="nav-item"><a href="https://www.github.com/wgf4242" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/text_del/ctf/005.reverse.01.assemble.html#汇编-asm-assemble" class="sidebar-link">汇编 ASM assemble</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#汇编基础" class="sidebar-link">汇编基础</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#常用的词汇解释" class="sidebar-link">常用的词汇解释</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#基础" class="sidebar-link">基础</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#test" class="sidebar-link">Test</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#示例" class="sidebar-link">示例</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#mov" class="sidebar-link">mov</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#sar" class="sidebar-link">sar</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#lea" class="sidebar-link">lea</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#leave-指令是将栈指针指向帧指针，然后pop备份的原帧指针到-ebp。" class="sidebar-link">LEAVE 指令是将栈指针指向帧指针，然后POP备份的原帧指针到%EBP。</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#ret-指令则是将栈顶的返回地址弹出到eip，然后按照eip此时指示的指令地址继续执行程序。" class="sidebar-link">RET 指令则是将栈顶的返回地址弹出到EIP，然后按照EIP此时指示的指令地址继续执行程序。</a></li><li class="sidebar-sub-header"><a href="/text_del/ctf/005.reverse.01.assemble.html#数组表示" class="sidebar-link">数组表示</a></li></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>wgf4242's Blog</span>
            
          <!---->
          2020
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1></h1> <hr> <div data-v-34ea29db><i class="iconfont reco-account" data-v-34ea29db><span data-v-34ea29db>wgf4242's Blog</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><p>[TOC]</p> <h2 id="汇编-asm-assemble"><a href="#汇编-asm-assemble" class="header-anchor">#</a> 汇编 ASM assemble</h2> <p>https://www.zrzz.site/2020/06/03/%E5%AE%9E%E9%AA%8C%E5%B9%B3%E5%8F%B0%E9%80%86%E5%90%91%E7%9F%A5%E8%AF%86/</p> <p><a href="http://faydoc.tripod.com/cpu/jne.htm" target="_blank" rel="noopener noreferrer">Link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.tutorialspoint.com/assembly_programming/assembly_conditions.htm" target="_blank" rel="noopener noreferrer">Link2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <table><thead><tr><th>类型</th> <th>2进制</th> <th>16进制</th></tr></thead> <tbody><tr><td>Byte 8位</td> <td>0000 0000</td> <td>0x0</td></tr> <tr><td>Word 16位</td> <td>0000 0000 0000 0000</td> <td>0x00</td></tr> <tr><td>DWord 32位</td> <td></td> <td>0x0000</td></tr></tbody></table> <h3 id="汇编基础"><a href="#汇编基础" class="header-anchor">#</a> 汇编基础</h3> <h4 id="pointer-registers"><a href="#pointer-registers" class="header-anchor">#</a> Pointer Registers</h4> <p>Article From Pluralsight - Getting_Started_with_Reverse_Engineering</p> <p>32-bit pointer registers with 16-bit portions</p> <ul><li><p>EIP – instruction pointer</p></li> <li><p>ESP – stack pointer</p></li> <li><p>EBP – base pointer</p></li></ul> <p>64-bit pointer registers</p> <ul><li><p>RIP – instruction pointer</p></li> <li><p>RSP – stack pointer</p></li> <li><p>RBP – base pointer</p></li></ul> <h4 id="index-registers"><a href="#index-registers" class="header-anchor">#</a> Index Registers</h4> <p>32-bit index registers with 16-bit portions</p> <ul><li><p>ESI – source index</p></li> <li><p>EDI – destination index</p></li></ul> <p>64-bit pointer registers</p> <ul><li><p>RSI – source index</p></li> <li><p>RDI – destination index</p></li></ul> <p>These are commonly used for copy operations</p> <h4 id="eflags-rflags"><a href="#eflags-rflags" class="header-anchor">#</a> EFLAGS &amp; RFLAGS</h4> <p>32 and 64 bit registers that represent the results of operations and the state of the CPU</p> <ul><li><p>Common values include:</p></li> <li><p>Carry flag - CF</p></li> <li><p>Zero flag - ZF</p></li> <li><p>Sign flag - SF</p></li> <li><p>Trap flag - TF</p></li> <li><p>Direction flag - DF</p></li> <li><p>Overflow flag - OF</p></li></ul> <p>The upper 32-bits of RFLAGS are reserved</p> <h4 id="processor-registers"><a href="#processor-registers" class="header-anchor">#</a> Processor Registers</h4> <p>32 bit systems are commonly considered to have 8 general purpose registers:</p> <table><thead><tr><th>32 bits</th> <th>Lower 16 bits</th> <th>Lower 8 bits</th> <th>Upper 8 bits</th></tr></thead> <tbody><tr><td>EAX</td> <td>AX</td> <td>AL</td> <td>AH</td></tr> <tr><td>EBX</td> <td>BX</td> <td>BL</td> <td>BH</td></tr> <tr><td>ECX</td> <td>CX</td> <td>CL</td> <td>CH</td></tr> <tr><td>EDX</td> <td>DX</td> <td>DL</td> <td>CL</td></tr> <tr><td>ESI</td> <td>SI</td> <td></td> <td></td></tr> <tr><td>EDI</td> <td>DI</td> <td></td> <td></td></tr> <tr><td>EBP</td> <td>BP</td> <td></td> <td></td></tr> <tr><td>ESP</td> <td>SP</td> <td></td> <td></td></tr></tbody></table> <p>64 bit architecture extends 32 bit general purpose registers and adds 8 more:</p> <p>64 bits|32 bits|Lower 16<br> bits|Lower 8<br> bits|Upper 8<br> bits
-|-|-|-|
RAX|EAX|AX|AL|AH
RBX|EBX|BX|BL|BH
RCX|ECX|CX|CL|CH
RDX|EDX|DX|DL|CL
RSI|ESI|SI|
RDI|EDI|DI|
RBP|EBP|BP|
RSP|ESP|SP|
R8 - R15|R8D|R8W|R8B</p> <h4 id="exe-结构"><a href="#exe-结构" class="header-anchor">#</a> EXE 结构</h4> <table><thead><th>段</th> <th>内容</th> <th>说明</th></thead> <tbody><tr><td>Header</td></tr> <tr><td rowspan="4">Section</td> <td>code(.text)</td> <td>text/.code: program instructions in binary state, entry point of program</td></tr> <tr><td>read-only data</td> <td>.data/.idata: initialized data</td></tr> <tr><td>resources</td> <td>.rsrc: resources used by the program – icons, images, arbitrary binary data</td></tr> <tr><td>other sections</td> <td>.bss: unitialized data</td></tr> <div class="language- extra-class"><pre><code>&lt;/tbody&gt;
</code></pre></div></tbody></table>
#### Executing a Program
<p>=&gt; virtual memory =&gt; 通常从0x400000 开始</p> <table><thead><tr><th>-</th> <th>-</th></tr></thead> <tbody><tr><td><code>[bits 32]</code></td> <td>Defines architecture</td></tr> <tr><td>section .text</td> <td>Defines the section for code</td></tr> <tr><td>global _START</td> <td>Defines the entry point</td></tr> <tr><td>_START</td> <td>Entry point</td></tr> <tr><td>push ebp</td> <td>Instructions</td></tr> <tr><td>mov esp, ebp</td> <td></td></tr> <tr><td>sub esp, 8h</td> <td>* NASM Syntax</td></tr></tbody></table> <p>Generating Machine Code</p> <ul><li><p>Write an instruction: xor eax, eax</p></li> <li><p>Translate:: assembler, compiler or interpreter</p></li> <li><p>Results in machine code: 0x31 0xC0</p></li></ul> <h4 id="essential-instructions"><a href="#essential-instructions" class="header-anchor">#</a> Essential Instructions</h4> <h5 id="arthmetic"><a href="#arthmetic" class="header-anchor">#</a> Arthmetic</h5> <table><thead><tr><th>ax</th> <th>0</th> <th>0</th> <th>0</th> <th>1</th> <th>0</th> <th>1</th> <th>1</th> <th>0</th> <th>1</th> <th>0</th> <th>1</th> <th>1</th> <th>1</th> <th>1</th> <th>1</th> <th>1</th></tr></thead> <tbody><tr><td>bx</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>1</td> <td>1</td> <td>0</td> <td>0</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> <td>1</td> <td>0</td> <td>0</td> <td>0</td></tr></tbody></table> <p>add ax, bx</p> <table><thead><tr><th>--</th> <th>1</th> <th>1</th> <th>1</th> <th>0</th> <th>0</th> <th>0</th> <th>1</th> <th>1</th> <th>0</th> <th>1</th> <th>1</th> <th>0</th> <th>0</th> <th>1</th> <th>1</th> <th>1</th></tr></thead> <tbody></tbody></table> <p>add al, bl</p> <table><thead><tr><th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>0</th> <th>1</th> <th>1</th> <th>0</th> <th>0</th> <th>1</th> <th>1</th> <th>1</th></tr></thead> <tbody></tbody></table> <p>sub al, bl</p> <table><thead><tr><th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>--</th> <th>0</th> <th>0</th> <th>0</th> <th>1</th> <th>0</th> <th>1</th> <th>1</th> <th>1</th></tr></thead> <tbody></tbody></table> <p><strong>Arthmetic - Multiplication</strong></p> <p>MUL</p> <ul><li><p>Unsigned multiply</p></li> <li><p>Uses an implicit argument based on operand size</p></li> <li><p>Example:</p></li> <li><p>MUL BX</p></li></ul> <p>IMUL</p> <ul><li><p>Signed multiply</p></li> <li><p>Uses one, two or three
operands</p></li> <li><p>Allows you to explicitly
define destination</p></li> <li><p>Example:</p></li> <li><p>IMUL DEST, SRC1, SRC2</p></li></ul> <table><thead><tr><th>operand size</th> <th style="text-align:center;">source(implicit)</th> <th>source2(explicit)</th> <th>destination</th></tr></thead> <tbody><tr><td>Byte 8 bits</td> <td style="text-align:center;">AL</td> <td>8 bit register or memory</td> <td>AX</td></tr> <tr><td>Word 16 bits</td> <td style="text-align:center;">AX</td> <td>16 bit register or memory</td> <td>DX:AX</td></tr> <tr><td>Double word 32 bits</td> <td style="text-align:center;">EAX</td> <td>32 bit register or memory</td> <td>EDX:EAX</td></tr> <tr><td>Quad word 64 bits</td> <td style="text-align:center;">RAX</td> <td>64 bit register or memory</td> <td>RDX:RAX</td></tr></tbody></table> <p><strong>Arthmetic - Division</strong></p> <p>DIV</p> <ul><li><p>Unsigned divide</p></li> <li><p>Uses an implicit argument based on operand size</p></li> <li><p>Example:</p></li> <li><p>DIV AX</p></li></ul> <p>IDIV</p> <ul><li><p>Signed divide</p></li> <li><p>Example:</p> <ul><li>IDIV AX</li></ul></li></ul> <table><thead><tr><th>operand size</th> <th style="text-align:center;">source(implicit)</th> <th>source2(explicit)</th> <th>destination</th></tr></thead> <tbody><tr><td>Byte 8 bits</td> <td style="text-align:center;">AX</td> <td>AH</td> <td>AL</td></tr> <tr><td>Word 16 bits</td> <td style="text-align:center;">DX:AX</td> <td>DX</td> <td>AX</td></tr> <tr><td>Double word 32 bits</td> <td style="text-align:center;">EDX:EAX</td> <td>EDX</td> <td>EAX</td></tr> <tr><td>Quad word 64 bits</td> <td style="text-align:center;">RDX:RAX</td> <td>RDX</td> <td>RAX</td></tr></tbody></table> <h5 id="performing-comparisons-cmp"><a href="#performing-comparisons-cmp" class="header-anchor">#</a> Performing Comparisons/Cmp</h5> <p>Results of the comparison update corresponding ”flags” in the E/RFLAGS register</p> <ul><li>Flags affected: CF, OF, SF, ZF, AF, PF</li></ul> <table><thead><tr><th>Instruction</th> <th>Description</th></tr></thead> <tbody><tr><td>JE / JZ</td> <td>Jump Equal or Jump Zero</td></tr> <tr><td>JNE / JNZ</td> <td>Jump Not Equal or Jump Not Zero</td></tr> <tr><td>JG / JNLE</td> <td>Jump Greater or Jump NotLess/Equal</td></tr> <tr><td>JGE / JNL</td> <td>Jump Greater/Equal or Jump NotLess</td></tr> <tr><td>JL / JNGE</td> <td>Jump Less or Jump NotGreater/Equal</td></tr> <tr><td>JLE / JNG</td> <td>Jump Less/Equal or Jump NotGreater</td></tr></tbody></table> <hr> <h5 id="the-call-function"><a href="#the-call-function" class="header-anchor">#</a> The Call Function</h5> <p>CALL is similar to a jump instruction, tells CPU where to go next.</p> <p>However, there is a key difference:</p> <ul><li>CALL pushes the address of the nextinstruction onto the stack</li></ul> <p><strong>A CALL is typically followed by a RET instruction</strong></p> <ul><li><p>RET POPs the value on top of the stack into EIP</p></li> <li><p>As long as the function is aligned, this
allows a function to return to where it
was called from</p></li></ul> <h4 id="bitwise-operations-endianness-and-size"><a href="#bitwise-operations-endianness-and-size" class="header-anchor">#</a> Bitwise Operations, Endianness and Size</h4> <h5 id="size-directives"><a href="#size-directives" class="header-anchor">#</a> Size Directives</h5> <p>You will need to think in terms of size and
not data types</p> <ul><li><p>quad-word (qword): 8 bytes / 64 bits</p></li> <li><p>double-word (dword): 4 bytes / 32 bits</p></li> <li><p>word: 2 bytes / 16 bits</p></li> <li><p>byte: 8 bits</p></li> <li><p>bit: a single 1 or 0</p></li></ul> <p>You may encounter and need to use these directives in your instructions:</p> <ul><li>mov word ptr [eax], bx</li></ul> <h5 id="endianness"><a href="#endianness" class="header-anchor">#</a> Endianness</h5> <p>When storing data in memory, the byte order is determined by architecture</p> <ul><li><p>Big-endian – most significant byte first</p></li> <li><p>Little-endian – least significant byte first</p></li></ul> <p>Only affects multi-byte values Keep in mind when debugging programs</p> <h3 id="常用的词汇解释"><a href="#常用的词汇解释" class="header-anchor">#</a> 常用的词汇解释</h3> <p>汇编zhidao语言中CS，DS，SS还有一个ES定义如下：</p> <div class="language- extra-class"><pre><code>CS（Code Segment）：代码段寄存器；
DS（Data Segment）：数据段寄存器；
SS（Stack Segment）：堆栈段寄存器；
ES（Extra Segment）：附加段寄存器。
LEA 传操作数地址。。Load Effectiv Address
BP Base Point 基址寻址器
</code></pre></div><p>当一个程序容要执行时，就要决定程序代码、数据和堆栈各要用到内存的哪些位置，通过设定段寄存器 CS，DS，SS 来指向这些起始位置。通常是将DS固定，而根据需要修改CS。</p> <p>SUB OPRD1，OPRD2 ：功能：两个操作数的相减，即从OPRD1中感去OPRD2, 保存到OPRD1中</p> <p>DH DL是DX寄存器的高位寄存器和低位寄存器，比如8086里DX是16位那H和L就是高8位和低8位，不过你也可以单独使用</p> <div class="language- extra-class"><pre><code>理解 dl 可能单独取第一个 byte 字符
</code></pre></div><p>inc eax, =&gt; eax +1  , 同dec</p> <p>dec esi, =&gt; esi - 1, 影响AF、OF、PF、SF、ZF标志位，但不影响CF标志位</p> <p>CDQ Convert Double to Quad, 32位转64位, edx扩展为eax的高位，也就是说变为64位</p> <div class="language- extra-class"><pre><code>把百edx的每一位置成eax的最高位（若eax&gt;=0x80000000, 则度edx=0xFFFFFFFF；若eax&lt;0x80000000，则edx=0x00000000） ，再把edx扩展为eax的高位。
</code></pre></div><p>int 3, CPU执行int n指令，相当于引发一个n号中断的中断过程。</p> <div class="language- extra-class"><pre><code>让程序产生一个interrupt 3
这个中断通常是给debug使用的
就是说，程序过运行收到Int 3
那么会去调用debug服务之类的
</code></pre></div><p>SAR, SHR</p> <div class="language- extra-class"><pre><code>Sar是算数右移指令（Shift Arithmetic Right），右移保留操作数的符号,即最高位不变
SHR是逻辑右移指令（Shift Logical Right）。右移时总是用0来补足。
例如10000000算数右移一位是11000000，而逻辑右移一位是01000000。
</code></pre></div><h4 id="跳转说明"><a href="#跳转说明" class="header-anchor">#</a> <strong>跳转说明</strong></h4> <div class="language- extra-class"><pre><code>JE   ;等于则跳转
JNE  ;不等于则跳转

JZ   ;为 0 则跳转
JNZ  ;不为 0 则跳转

JS   ;为负则跳转
JNS  ;不为负则跳转

JC   ;进位则跳转
JNC  ;不进位则跳转

JO   ;溢出则跳转
JNO  ;不溢出则跳转

JA   ;无符号大于则跳转
JNA  ;无符号不大于则跳转
JAE  ;无符号大于等于则跳转
JNAE ;无符号不大于等于则跳转

JG   ;有符号大于则跳转
JNG  ;有符号不大于则跳转
JGE  ;有符号大于等于则跳转
JNGE ;有符号不大于等于则跳转

JB   ;无符号小于则跳转
JNB  ;无符号不小于则跳转
JBE  ;无符号小于等于则跳转
JNBE ;无符号不小于等于则跳转

JL   ;有符号小于则跳转
JNL  ;有符号不小于则跳转
JLE  ;有符号小于等于则跳转
JNLE ;有符号不小于等于则跳转

JP   ;奇偶位置位则跳转
JNP  ;奇偶位清除则跳转
JPE  ;奇偶位相等则跳转
JPO  ;奇偶位不等则跳转
</code></pre></div><h4 id="标志位"><a href="#标志位" class="header-anchor">#</a> 标志位</h4> <div class="language- extra-class"><pre><code>CF:     进位标志符号比         排在第0位
PF:     奇偶标志                     排在第2位
AF:     辅助进位标志             排在第4位
ZF:     零标志                         排在第6位
SF:     符号标志                     排在第7位
TF:     追踪标志                     排在第8位
IF:      中断允许标志             排在第9位
DF:    方向标志                     排在第10位
OF:    溢出标志                     排在第11位
</code></pre></div><p>跳转相关的标志位:</p> <table><thead><tr><th>11</th> <th>10</th> <th>9</th> <th>8</th> <th>7</th> <th>6</th> <th>5</th> <th>4</th> <th>3</th> <th>2</th> <th>1</th> <th>0</th></tr></thead> <tbody><tr><td>OF</td> <td>DF</td> <td>IF</td> <td>TF</td> <td>SF</td> <td>ZF</td> <td></td> <td>AF</td> <td></td> <td>PF</td> <td></td> <td>CF</td></tr> <tr><td>溢出</td> <td></td> <td></td> <td></td> <td>符号</td> <td>零</td> <td>span</td> <td>辅助</td> <td>未用</td> <td>奇偶</td> <td>未用</td> <td>进位</td></tr></tbody></table> <h3 id="基础"><a href="#基础" class="header-anchor">#</a> 基础</h3> <p>计算机通常是32位处理。 快速负转正</p> <p>bytes</p> <div class="language- extra-class"><pre><code>-1 = 256 - 1 = 2^8 -1
-2 = 256 - 1 = 2^8 -2
</code></pre></div><p>word</p> <div class="language- extra-class"><pre><code>-1 = 65536 - 1 = 2^16 - 1
-2 = 65536 - 1 = 2^16 - 2
</code></pre></div><p>一个有符号定点数的最高位为符号位，0是正，1是副。</p> <p>负数： 最高位为1时为负数, 求补码就可以知道负多少。</p> <table><thead><tr><th>说明</th> <th>示例</th> <th>数值</th></tr></thead> <tbody><tr><td>bytes 8位</td> <td>1111 1111</td> <td>-1</td></tr> <tr><td></td> <td>1111 1100</td> <td>-4</td></tr> <tr><td>32位</td> <td>1111 1111 1111 1111 1111 1111 1111 1111</td> <td>-1</td></tr> <tr><td>32位</td> <td>1111 1111 1111 1111 1111 1111 1111 0000</td> <td>-16</td></tr></tbody></table> <p>负数的反码是将其原码除符号位之外的各位求反</p> <p>[-3]反=[10000011]反=11111100</p> <p>负数的补码是将其原码除符号位之外的各位求反之后在末位再加1。</p> <p>[-3]补=[10000011]补=11111101</p> <p>-2 = 2的反码+1</p> <p>-3 = 3的反码+1</p> <p>1字节 转换 [x]反+1=-x ， 反向也是这么转</p> <p>1转-1 FF 为 -1， 1为1</p> <p>2转-2 2 =2反+1 = 11111101b(即-3) + 1 = -2
-2转2 -2=-2反-1= [11111110b(-2) -1]反 =2</p> <h3 id="test"><a href="#test" class="header-anchor">#</a> Test</h3> <p><a href="https://blog.csdn.net/qwq1503/article/details/101976846" target="_blank" rel="noopener noreferrer">Test<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 逻辑与操作， 常用测试寄存器是否为空:</p> <div class="language- extra-class"><pre><code>test ecx, ecx
jz somewhere
</code></pre></div><p>如果ecx为零,设置ZF零标志为1,Jz跳转</p> <h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language- extra-class"><pre><code>lea ebx,dword ptr ds:[ebx]
/mov cx,word ptr ds:[eax]                ;  将eax的word-&gt;即前两位 给cx
|add eax,0x2                             ;  eax指向下一字符
|test cx,cx                              ;  cx寄存器是否为空, 即指针下是否有字符, 为空时z置1否则置0
\jnz short CTF_100_.00D81060             ;  nz 时跳转 , nz not zero
sub eax,edx                              ;  现在地址-原来的地址即数组长度, 保存到eax
sar eax,1                                ;  除以2, 每个字符2长度, 看多少字符
cmp eax,0x10                             ;  需要16位
ja CTF_100_.00D8116B
test eax,eax                             ;  判断为空
je CTF_100_.00D8116B
lea ecx,[local.321]                      ;  输入的字符写到ecx
call CTF_100_.00D81180                   ;  关键call
cmp eax,-0x1
je CTF_100_.00D8116B
lea edx,[local.321]
push edx
push CTF_100_.00D8DA20                   ;  {FLAG:%s}\n
</code></pre></div><h4 id="计算长度"><a href="#计算长度" class="header-anchor">#</a> 计算长度</h4> <div class="language- extra-class"><pre><code>mov     cx, word ptr [eax]
add     eax, 2
test    cx, cx
jnz     short 004020F6
</code></pre></div><h3 id="mov"><a href="#mov" class="header-anchor">#</a> mov</h3> <p>mov ax,word ptr [bx] 解释</p> <div class="language- extra-class"><pre><code>mov ax,word ptr [bx];是把内存地址等于“BX寄存器的值”的地copy方所存放的数据，赋予ax。由于只是给出一个内存地址，不知道希望赋百予ax的，是byte还是word，所以需要用word明确指度出！ ptr是显示申明（还是声明？）知
所以，当两个操作数的宽度不一样时，就要用到，
这里的宽度是指bit说简单点就是 16位的还是8位的！
cpu内部的寄存器，是16位的，（老了吧？）
而内存的单位寻址是8位的，所以他们的宽度不一样
就需要显示声道明ptr,
当你用dw和dt、db等时，就需要他来显示声明了，
</code></pre></div><h3 id="sar"><a href="#sar" class="header-anchor">#</a> sar</h3> <div class="language- extra-class"><pre><code>sar eax,1 就是把eax的32位数算术右移一位。度
eax的值为7（0000...0111）  移位以后
eax的值为3（0000...0011）。
移出的最低位（1）放到cf中。
右移一位道相当于除以2。
算术右回移是说移动过程中保答持最高位不变。
</code></pre></div><h3 id="lea"><a href="#lea" class="header-anchor">#</a> lea</h3> <p>举个例子，要计算两个寄存器的和，但又不想破坏原来的值，那么可以执行</p> <div class="language- extra-class"><pre><code>lea ebx ,[eax+edx]
</code></pre></div><p>这条指令，执行的就是 <code>ebx = eax + edx</code> 这条加法运算。如果用add指令，则不可能一条指令内完成。</p> <div class="language- extra-class"><pre><code>lea rdx, [rbp-90h]  // rdx=rbp-0x90
</code></pre></div><p>3.在汇编语言程序设计中，在需要取得一个变量地址时，使用LEA是很方便的。而MOV指令则常常出错，因为在微软MASM汇编语法中，label和variable是不同的。</p> <p>例2</p> <div class="language- extra-class"><pre><code>lea     edx, dword_9595EC

edx = dword_9595EC
</code></pre></div><h3 id="leave-指令是将栈指针指向帧指针，然后pop备份的原帧指针到-ebp。"><a href="#leave-指令是将栈指针指向帧指针，然后pop备份的原帧指针到-ebp。" class="header-anchor">#</a> LEAVE 指令是将栈指针指向帧指针，然后POP备份的原帧指针到%EBP。</h3> <h3 id="ret-指令则是将栈顶的返回地址弹出到eip，然后按照eip此时指示的指令地址继续执行程序。"><a href="#ret-指令则是将栈顶的返回地址弹出到eip，然后按照eip此时指示的指令地址继续执行程序。" class="header-anchor">#</a> RET 指令则是将栈顶的返回地址弹出到EIP，然后按照EIP此时指示的指令地址继续执行程序。</h3> <h3 id="数组表示"><a href="#数组表示" class="header-anchor">#</a> 数组表示</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>.text:009595EC dword_9595EC dd 2
.text:009595F0 dd offset dword_9595F4

v2=9595EC
v6=v2[1] //9595F4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/text_del/assets/js/app.cb1aaf83.js" defer></script><script src="/text_del/assets/js/4.1570c86b.js" defer></script><script src="/text_del/assets/js/1.9204637f.js" defer></script><script src="/text_del/assets/js/24.f77110de.js" defer></script>
  </body>
</html>
